# knowledge.py - 股市新手村 (V97 終極百科全書版)

# --- 1. 名詞解釋 (超級詳細版) ---
STOCK_TERMS = {
    "🔰 幼兒園：交易規則與基礎": {
        "T+2 交割制度": """
**【👶 這是什麼？】**
這就像你在網拍買東西，不用馬上付錢，**兩天後 (T+2)** 早上 10 點前銀行才會扣款。
* **T日**：你週一買股票。
* **T+2日**：週三早上 10 點前，你的銀行戶頭要有足夠的錢。

**【⚠️ 嚴重警告 - 違約交割】**
如果你帳戶裡的錢不夠扣（哪怕只少 1 元），就會發生「違約交割」。
* **後果 1**：你的信用破產，以後辦房貸、車貸、信用卡全部被拒絕。
* **後果 2**：券商會告你，你還得賠償違約金（最高 7%）。
* **結論**：沒錢千萬不要亂下單！
""",
        "漲跌停限制 (10%)": """
**【👶 這是什麼？】**
為了怕大家太嗨或太絕望，台股規定一天最多只能漲或跌 **10%**。
假設股價 100 元：
* **漲停板 (Limit Up)**：最高漲到 110 元。這時候通常只有人想買，沒人想賣。
* **跌停板 (Limit Down)**：最低跌到 90 元。這時候通常只有人想賣，沒人想買。

**【💡 實戰冷知識】**
* 看到 **🔴 漲停**：代表主力由守轉攻，氣勢超強，隔天通常容易開高。
* 看到 **🟢 跌停**：代表主力棄守或重大利空，千萬不要去「接刀子」，小心還有更低點。
""",
        "試撮 (08:30~09:00)": """
**【👶 這是什麼？】**
正式開盤前 30 分鐘，系統會模擬撮合，讓大家看「如果現在開盤會是多少錢」。

**【💣 詐騙陷阱】**
主力超愛利用這段時間騙人！
他們會掛「漲停價」買進，讓你以為今天會大漲，趕快跟單；結果在 **08:59:59** 瞬間把單抽走。
**結論**：試撮看到的價格都是「假的」，眼睛業障重，千萬別信！
""",
        "ROD / IOC / FOK (委託種類)": """
**【👶 這是什麼？】**
下單時的小設定，決定你的單子怎麼成交。
* **ROD (當日有效)**：最常用！掛單後，直到收盤都有效。散戶用這個就對了。
* **IOC (立即成交否則取消)**：我要現在立刻買到，沒買到的部分直接取消。
* **FOK (全部成交否則取消)**：我要買 10 張，少一張我都不買。通常是大戶在用的。
"""
    },
    "📊 小學部：看懂 K 線 (Candlestick)": {
        "K 線 (紅K / 綠K)": """
**【👶 這是什麼？】**
K 線是紀錄股價一天走勢的畫畫。
* **🔴 紅 K (陽線)**：收盤價 > 開盤價。代表今天**買方贏了**，股價漲上去。
* **🟢 綠 K (陰線)**：收盤價 < 開盤價。代表今天**賣方贏了**，股價被打下來。
* **影線 (那根細細的)**：
    * **上影線**：代表上面有人在賣 (壓力)。
    * **下影線**：代表下面有人在接 (支撐)。

**【💡 實戰口訣】**
* **實體紅 K 越長**：買氣越強，明天續漲機率高。
* **下影線越長**：像一根針刺下去又收回來，代表低檔支撐很強 (神針探底)。
""",
        "成交量 (Volume)": """
**【👶 這是什麼？】**
代表今天這檔股票總共交易了多少張。**「量是價的先行指標」**。

**【💡 實戰心法】**
* **價漲量增 (好)**：股價漲，成交量也變大。代表大家搶著買，是健康的漲勢。
* **價漲量縮 (警訊)**：股價漲，但沒人買。這叫「虛漲」，隨時會掉下來。
* **爆大量 (危險)**：在高檔突然爆出歷史天量，通常是主力趁亂出貨，快逃！
"""
    },
    "📈 中學部：技術指標大解密": {
        "MA 移動平均線 (均線)": """
**【👶 這是什麼？】**
把過去幾天的收盤價加起來除以天數，代表大家的「平均成本」。
* **5 日線 (5MA)**：攻擊線。強勢股會沿著 5 日線一直噴，跌破代表短線轉弱。
* **20 日線 (20MA)**：**月線**，又稱「生命線」。股票的這波趨勢是多頭還是空頭，就看這條。
    * **股價 > 月線**：多頭 (做多)。
    * **股價 < 月線**：空頭 (做空或空手)。
* **60 日線 (60MA)**：**季線**。大型股或存股族看的，跌破季線通常代表中期走勢壞掉了。
""",
        "KD 指標": """
**【👶 這是什麼？】**
用來判斷現在股價是「太貴」還是「太便宜」。數值在 0~100 之間。

**【💡 怎麼用？】**
* **黃金交叉 (買進)**：K值 從下往上穿過 D值。通常發生在數值 20 附近最準。
* **死亡交叉 (賣出)**：K值 從上往下穿過 D值。通常發生在數值 80 附近。
* **高檔鈍化 (超強)**：KD 一直卡在 80 以上掉不下來。這代表股價**超級強勢**，千萬別亂放空，可能會噴到外太空。
""",
        "MACD 指標": """
**【👶 這是什麼？】**
中長期的趨勢指標，比 KD 反應慢，但比較準，不會忽上忽下。

**【💡 怎麼用？】**
* **紅柱子 (多頭)**：柱狀體是紅色的，而且越來越長 → 股價正在漲。
* **綠柱子 (空頭)**：柱狀體是綠色的，而且越來越長 → 股價正在跌。
* **0 軸**：海平面。股價站上 0 軸代表正式進入多頭世界。
"""
    },
    "💰 大學部：籌碼與主力": {
        "三大法人": """
**【👶 這是什麼？】**
市場上最有錢的三種人，跟著他們做通常有肉吃。
1. **外資 (Foreign)**：外國來的資金。錢最多，喜歡買**台積電、大型權值股**。他們買股票是為了長線投資。
2. **投信 (Investment Trust)**：國內的基金公司。錢來自散戶，喜歡炒作**中小型股**。他們有季底作帳壓力，所以季末容易有飆股。
3. **自營商 (Dealer)**：券商自己的部門。做極短線，今天買明天賣，參考價值最低。
""",
        "融資 (Margin Trading)": """
**【👶 這是什麼？】**
跟券商借錢買股票。這是**散戶指標**。
* **融資暴增**：代表散戶全衝進去了。這時候籌碼很亂，主力不想拉抬，股價容易跌。
* **融資大減**：代表散戶認賠殺出了。這時候籌碼乾淨，主力容易進場拉抬。
"""
    },
    "🏢 研究所：基本面財報": {
        "EPS (每股盈餘)": """
**【👶 這是什麼？】**
公司每一股賺了多少錢。
* **公式**：稅後淨利 / 總股數
* **意義**：股價最終還是要看 EPS。EPS 成長，股價才會長紅。
""",
        "本益比 (PE Ratio)": """
**【👶 這是什麼？】**
買這張股票，要幾年才能回本？
* **公式**：股價 / EPS
* **標準**：
    * **< 10 倍**：便宜 (或公司快倒了)。
    * **15~20 倍**：合理。
    * **> 30 倍**：太貴了 (除非是高成長的科技股)。
"""
    },
    "🧘 博士班：心法與避雷針": {
        "停損 (Stop Loss)": """
**【👶 這是什麼？】**
承認錯誤，賠錢賣出。
**【💡 為什麼重要？】**
股市最重要的一課就是「活下去」。
如果你虧損 50%，下次要賺 100% 才能回本！
所以，設定一個停損點 (例如 -10%)，跌破就砍，絕不留戀。**留得青山在，不怕沒柴燒。**
""",
        "凹單": """
**【👶 這是什麼？】**
賠錢了不賣，催眠自己「只要不賣就不算賠」，期待它有一天漲回來。
**【💣 後果】**
這是散戶破產的主因！很多股票跌下去就再也回不來了 (例如宏達電從 1300 跌到 30)。千萬別凹單！
""",
        "左側 vs 右側交易": """
* **左側交易 (摸底)**：股價還在跌，你覺得到底了，進場去買。成本低，但容易「接刀子」滿手血。
* **右側交易 (順勢)**：股價跌完開始漲了，確認趨勢向上才買。成本高一點，但勝率比較高。**新手建議做右側！**
"""
    }
}

# --- 2. K線型態詳細教學 (圖文並茂版) ---
KLINE_PATTERNS = {
    "bull": { # 多方型態
        "錘頭線 (Hammer)": {
            "morphology": "實體很小，**下影線超長** (像一根鐵鎚)。",
            "psychology": "🔨 **主力神救援！**\n開盤空軍用力下殺，結果多軍大部隊在低檔埋伏，一口氣把股價推回高點。代表低檔有人在顧，跌不下去了。",
            "action": "看到這根針，準備做多！設下影線最低點為停損。",
            "data": [[100, 100, 92, 99]]
        },
        "紅三兵 (Three White Soldiers)": {
            "morphology": "連續三天出現紅 K 棒，每天收盤都比昨天高。",
            "psychology": "💂‍♂️ **多頭大軍進攻！**\n買氣一天比一天強，空軍完全被輾壓。這是強烈的趨勢反轉訊號。",
            "action": "趨勢確立，拉回 5 日線不破就買進。",
            "data": [[90, 93, 90, 92], [92, 95, 91, 94], [94, 98, 93, 97]]
        },
        "晨星 (Morning Star)": {
            "morphology": "1.長綠K → 2.十字星 → 3.長紅K。",
            "psychology": "🌟 **黎明前的曙光！**\n第一天大跌(絕望)，第二天跌不動(猶豫)，第三天大漲(反攻)。結構非常紮實的底部訊號。",
            "action": "第三根紅K收盤確認時，大膽買進。",
            "data": [[105, 105, 95, 96], [94, 95, 93, 94], [96, 104, 96, 103]]
        }
    },
    "bear": { # 空方型態
        "流星線 (Shooting Star)": {
            "morphology": "實體很小，**上影線超長** (像避雷針)。",
            "psychology": "⚡ **多頭被賞巴掌！**\n原本想攻高，結果遇到高檔賣壓，被打得鼻青臉腫回來。代表上面住滿了想賣股票的人。",
            "action": "看到避雷針，快逃！小心被雷劈。",
            "data": [[100, 110, 100, 101]]
        },
        "黑三鴉 (Three Black Crows)": {
            "morphology": "連續三天出現綠 K 棒，每天收盤都比昨天低。",
            "psychology": "🐦‍⬛ **死神降臨！**\n主力連續三天倒貨，買盤完全潰散。通常是大跌段的開始。",
            "action": "這時候不要想著接刀，有多少賣多少。",
            "data": [[105, 105, 100, 102], [102, 102, 96, 98], [98, 98, 92, 94]]
        },
        "夜星 (Evening Star)": {
            "morphology": "1.長紅K → 2.十字星 → 3.長綠K。",
            "psychology": "🌑 **黑夜降臨！**\n高檔衝不上去，多空勢力反轉，空軍正式接管戰場。",
            "action": "確認成型後，果斷離場。",
            "data": [[95, 102, 95, 101], [103, 104, 102, 103], [102, 102, 92, 93]]
        }
    }
}

# --- 3. 策略詳細說明 ---
STRATEGY_DESC = """
### 🤖 AI 戰情室：四大獲利策略解密

我們不是亂槍打鳥，而是運用 **大數據與量化指標** 來篩選股票。以下是四大策略的運作邏輯：

#### 💎 1. 超強力推薦必賺 (Super Win)
> **"這是一套嚴格的交集策略，專抓主升段飆股！"**

* **核心邏輯**：同時滿足趨勢、動能、籌碼三個維度，缺一不可。
* **篩選條件**：
    1.  ✅ **趨勢全多頭**：股價 > 月線 > 季線 (多頭排列)。
    2.  ✅ **動能爆發**：MACD 黃金交叉 (柱狀體翻紅) + RSI 在 55~80 強勢攻擊區。
    3.  ✅ **籌碼進駐**：成交量爆增 (量增價漲)，代表主力真金白銀買進。
* **適合誰**：追求高勝率、喜歡波段大賺的投資人。

---

#### ⚡ 2. 強力當沖 (Day Trade)
> **"今天買，今天賣，絕不留倉過夜！"**

* **核心邏輯**：尋找當日市場最熱絡、波動最大的標的。
* **篩選條件**：
    1.  ✅ **爆量**：今日預估量 > 昨日成交量 1.5 倍以上。
    2.  ✅ **開高走高**：股價 > 開盤價 > 5日線。
* **操作心法**：**快進快出**。賺了就跑，賠了更要跑 (嚴設停損)。

---

#### 📈 3. 穩健短線 (Short Swing)
> **"買在起漲點，享受一段 3~5 天的漲幅。"**

* **核心邏輯**：順勢交易，買在均線支撐之上。
* **篩選條件**：
    1.  ✅ **站上月線**：股價穩穩站在 20MA 之上。
    2.  ✅ **短線轉強**：5日線 黃金交叉 20日線。
* **適合誰**：沒時間盯盤，想做一個小波段的上班族。

---

#### 🐢 4. 長線安穩 (Long Term)
> **"好公司遇到倒楣事，就是最好的買點。"**

* **核心邏輯**：價值投資，買在股價被低估或超跌的時候。
* **篩選條件**：
    1.  ✅ **季線支撐**：股價回測 60MA (季線) 附近不破。
    2.  ✅ **乖離率低**：股價沒有離均線太遠，買得安全。
* **適合誰**：存股族，想要安穩領股息並賺取長線價差的人。
"""
